<template>
  <div data-name="services">
      <div class="tab tab-active" id="tab-1">

        <div class="padding">
            <a id="quiz-button" href="#" @click="checkQuestionnaries()" class="col button button-fill color-pink">Questionários pendentes</a>
        </div>
        <div id="card-sleep" class="sleeplevel-questionnaire display-none" >
            <div class="card no-margin" id="happynesslevel">
                <div id="card-content-sleep" class="h100">
                    <div class="card-question card-content card-content-padding">
                        Como tem sido a qualidade do seu sono nos últimos 7 dias?
                    </div>
                    <div class="row padding">
                        <div class="col-20" >
                            <div>
                                <a href="#" @click="sleepLevel(0)"><img src="../static/images/affective-slider/AS_unhappy.svg" style="width: 100%;"></a>
                            </div>
                        </div>
                        <div class="col-20" >
                            <div>
                                <a href="#" @click="sleepLevel(1)"><img src="../static/images/affective-slider/AS_sleepy.svg" style="width: 100%;"></a>
                            </div>
                        </div>
                        <div class="col-20" >
                            <div>
                                <a href="#" @click="sleepLevel(2)"><img src="../static/images/affective-slider/AS_wideawake.svg" style="width: 100%;"></a>
                            </div>
                        </div>
                        <div class="col-20" >
                            <div>
                                <a href="#" @click="sleepLevel(3)"><img src="../static/images/affective-slider/AS_intensity_cue.svg" style="width: 100%;"></a>
                            </div>
                        </div>
                        <div class="col-20" >
                            <div>
                                <a href="#" @click="sleepLevel(4)"><img src="../static/images/affective-slider/AS_happy.svg" style="width: 100%;"></a>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="display-none" id="thanks-for-response-sleep">
                    <div class="card-question card-content card-content-padding">
                        Como tem sido a qualidade do seu sono nos últimos 7 dias?
                    </div>
                    <div class="row padding">
                        <div class="col-2" >
                        </div>
                        <div class="col-2" >
                        </div>
                        <div class="col-92 text-align-center" >
                            <p>Obrigado pela sua resposta :)</p>
                        </div>
                        <div class="col-2" >
                        </div>
                        <div class="col-2" >
                        </div>
                    </div>
                    
                </div>
            </div>
        </div>


        <div class="happynesslevel-questionnaire" >
            <div class="card no-margin" id="happynesslevel">
                <div id="cardContent" class="h100">
                    <div class="card-question card-content card-content-padding">
                        Como você está se sentindo agora?
                    </div>
                    <div class="row padding">
                        <div class="col-20" >
                            <div>
                                <a href="#" @click="happynessLevel(0)" id="unHappy"><img src="../static/images/affective-slider/AS_unhappy.svg" style="width: 100%;"></a>
                            </div>
                        </div>
                        <div class="col-20" >
                            <div>
                                <a href="#" @click="happynessLevel(1)"><img src="../static/images/affective-slider/AS_sleepy.svg" style="width: 100%;"></a>
                            </div>
                        </div>
                        <div class="col-20" >
                            <div>
                                <a href="#" @click="happynessLevel(2)"><img src="../static/images/affective-slider/AS_wideawake.svg" style="width: 100%;"></a>
                            </div>
                        </div>
                        <div class="col-20" >
                            <div>
                                <a href="#" @click="happynessLevel(3)"><img src="../static/images/affective-slider/AS_intensity_cue.svg" style="width: 100%;"></a>
                            </div>
                        </div>
                        <div class="col-20" >
                            <div>
                                <a href="#" @click="happynessLevel(4)"><img src="../static/images/affective-slider/AS_happy.svg" style="width: 100%;"></a>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="display-none" id="thanks-for-response">
                    <div class="card-question card-content card-content-padding">
                        Como você está se sentindo agora?
                    </div>
                    <div class="row padding">
                        <div class="col-2" >
                        </div>
                        <div class="col-2" >
                        </div>
                        <div class="col-92 text-align-center" >
                            <p>Obrigado pela sua resposta :)</p>
                        </div>
                        <div class="col-2" >
                        </div>
                        <div class="col-2" >
                        </div>
                    </div>
                    
                </div>
            </div>
        </div>

        <div class="menu-grid">
            <a href="/about-more/" class="menu-grid__item">
                <div class="item-inner">
                    <img src="static/images/ask-for-help.png" class="menu-grid__icon">
                    <div class="item-title">Transtornos mais comuns</div>
                </div>
            </a>

            <a href="/prevention/" class="menu-grid__item">
                <div class="item-inner">
                    <img src="static/images/feeling-down.png" class="menu-grid__icon">
                    <div class="item-title">Principais sintomas</div>
                </div>
            </a>

            <a href="/reasons/" class="menu-grid__item">
                <div class="item-inner">
                    <img src="static/images/feeling-blue.png" class="menu-grid__icon">
                    <div class="item-title">Fatores responsáveis</div>
                </div>
            </a>

            <a href="/where-help/" class="menu-grid__item">
                <div class="item-inner">
                    <img src="static/images/know-yourself.png" class="menu-grid__icon">
                    <div class="item-title">Preconceitos e tabus</div>
                </div>
            </a>

            <a href="/health-tips/" class="menu-grid__item">
                <div class="item-inner">
                    <img src="static/images/nourish-your-mind.png" class="menu-grid__icon">
                    <div class="item-title">Dicas</div>
                </div>
            </a>

            <a href="/sleep-tips/" class="menu-grid__item">Unhappy
            
            <a href="/contact/" class="menu-grid__item">
                <div class="item-inner">
                    <img src="static/images/go-to-therapy.png" class="menu-grid__icon">
                    <div class="item-title">Atendimento Emergencial</div>
                </div>
            </a>

            <a href="/leisure-tips/" class="menu-grid__item">
                <div class="item-inner">
                    <img src="static/images/leisure.png" class="menu-grid__icon">
                    <div class="item-title">Lazer</div>
                </div>
            </a>
          
            <a href="/wellness-quiz/" class="menu-grid__item">
                <div class="item-inner">
                    <img src="static/images/quiz.png" class="menu-grid__icon">
                    <div class="item-title">Questionário de Bem-Estar</div>
                </div>
            </a>
          
            <a href="/hr/" class="menu-grid__item">
                <div class="item-inner">
                    <img src="static/images/heartbeat.png" class="menu-grid__icon">
                    <div class="item-title">Batimento Cardíaco</div>
                </div>
            </a>

          </div>
      </div>
  </div>
</template>
<script>
    
    export default {
        methods: {
            checkQuestionnaries: function () {
                var self = this;
                var app = self.$app;
                
                let needSleepQuestionarie = this.checkNeedSleepQuestionnarie();

                var quizButton = this.$$("#quiz-button");

                if (needSleepQuestionarie == false){
                    quizButton.text("Não há questionários pendentes");
                    quizButton.removeClass("color-pink");
                    quizButton.addClass("color-green");
                }
            },
            checkNeedSleepQuestionnarie: function(){
                var self = this;
                var app = self.$app;

                let sleepCard = this.$$("#card-sleep");
                let sleepHistory = app.storage.getSleepHistory();

                if(sleepHistory == null) {
                    sleepCard.removeClass('display-none');
                    return true;
                }

                let lastUpdateFromStorage = sleepHistory.history[sleepHistory.history.length - 1];
                let lastUpdate = new Date(lastUpdateFromStorage.created_at);
                let now = new Date();

                if (now.getFullYear() === lastUpdate.getFullYear() && now.getMonth() === lastUpdate.getMonth() && now.getDate() === lastUpdate.getDate()){
                    sleepCard.addClass('display-none');
                    return false;
                } else {
                    sleepCard.removeClass('display-none');
                    return true;
                }
            },
            sleepLevel: function(awnser){
                var self = this;
                var app = self.$app;
        
                var pollCard = this.$$("#card-content-sleep");
                var pollThanks = this.$$("#thanks-for-response-sleep");
                let sleepCard = this.$$("#card-sleep");

                app.storage.setSleepHistory(awnser);

                pollCard.addClass('display-none');
                pollThanks.removeClass('display-none');
                setTimeout(function () {
                        pollThanks.addClass('display-none');
                        pollCard.removeClass('display-none');
                        sleepCard.addClass('display-none');   
                        }, 3000);
            },
            happynessLevel: function(awnser){
            var self = this;
            var app = self.$app;
     
            var pollCard = this.$$("#cardContent");
            var pollThanks = this.$$("#thanks-for-response");

            app.storage.setHappynessHistory(awnser);

            pollCard.addClass('display-none');
            pollThanks.removeClass('display-none');
            setTimeout(function () {
                    pollThanks.addClass('display-none');
                    pollCard.removeClass('display-none');   
                    }, 30000);
        },
        },
    };
</script>
<style>
    .menu-grid {
        padding: 10px;
        display: grid;
        grid-template-columns: repeat(auto-fill, calc(50% - 5px));
        grid-gap: 10px;
    }

    .menu-grid__item {
        background-color: #f6f6f6;
        text-align: center;
        text-transform: uppercase;
        color: #1e2f42;
        font-weight: bold;
        padding: 10px;
    }

    .menu-grid__item.small {
        vertical-align: middle;
        font-weight: 400;
        padding: 8px;
        text-align: left;
        background-color: #dff1e0;
        font-size: 0.8em;
    }

    .menu-grid__item.small i {
        float: left;
        margin-top: 8px;
        margin-right: 10px;
        font-size: 1.8em;
    }

    .menu-grid__icon {
        height: 55px;
    }

    .card-question {
      font-size: 16px;
      font-weight: 500;
      text-align: justify;
    }

    .sleeplevel-questionnaire {
        padding: 10px;
    }
    
    .happynesslevel-questionnaire {
        padding: 10px;
    }
    .h100 {
        height: 100%;
    }

</style>
